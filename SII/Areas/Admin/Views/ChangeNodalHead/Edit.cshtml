
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}


<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default panel-border-color panel-border-color-custom panel-table">
            <div class="panel-heading">
                Nodal Officer and Head of Instituted Details
                <div class="tools">
                    <a href="@Url.Content("~/")Admin/ChangeNodalHead" class="btn btn-success">Back</a>
                </div>
            </div>
            <div class="tab-container">
                <div class="tab-content">
                    @*Approx Cost Of living*@
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="panel-body">
                                @{
                                    SIIRepository.Adminservice.DashboardRepository _objRepo = new SIIRepository.Adminservice.DashboardRepository();
                                    System.Data.DataSet _ds = _objRepo.SELECT_tbl_InstituteNodalAndHeadOfficers(ViewBag.id);
                                    if (_ds != null)
                                    {
                                        if (_ds.Tables[0].Rows.Count > 0)
                                        {
                                            int i = 1;
                                            foreach (System.Data.DataRow _dr in _ds.Tables[0].Rows)
                                            {
                                <form id="frm">
                                    @Html.AntiForgeryToken()
                                    <input type="hidden" name="InstituteID" value="@_dr["InstituteID"].ToString()" />
                                    <div class="panel-body">
                                        <h3><span class="text-primary">@_dr["InstituteName"].ToString() </span>(@_dr["InstituteID"].ToString())</h3>
                                        <h4 class="form-title-h4">Head of the Institute</h4>
                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Prefix&nbsp; <span style="color: red">*</span></label>
                                                    <select class="form-control" name="HeadPrefix" required="">
                                                        <option value="">--Select Prefix--</option>
                                                        <option @(_dr["HeadPrefix"].ToString() == "Mr." ? "selected" : "")>Mr.</option>
                                                        <option @(_dr["HeadPrefix"].ToString() == "Mrs." ? "selected" : "")>Mrs.</option>
                                                        <option @(_dr["HeadPrefix"].ToString() == "Miss." ? "selected" : "")>Miss.</option>
                                                        <option @(_dr["HeadPrefix"].ToString() == "Dr." ? "selected" : "")>Dr.</option>
                                                        <option @(_dr["HeadPrefix"].ToString() == "Prof." ? "selected" : "")>Prof.</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>First Name&nbsp; <span style="color: red">*</span></label>
                                                    <input type="text" id="txtHeadFirstName" class="form-control" placeholder="First Name" name="HeadFirstName" required="" value="@_dr["HeadFirstName"].ToString()" />
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Last Name&nbsp; <span style="color: red">*</span></label>
                                                    <input type="text" id="txtHeadLastName" class="form-control" placeholder="Last Name" name="HeadLastName" required="" value="@_dr["HeadLastName"].ToString()" />
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Email&nbsp; <span style="color: red">*</span></label>
                                                    <input type="email" id="txtHeadEmail" class="form-control" placeholder="Email" name="HeadEmail" required="" value="@_dr["HeadEmail"].ToString()" />
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Mobile&nbsp; <span style="color: red">*</span></label>
                                                    <input type="text" id="txtHeadMobile" data-parsley-type="number" data-parsley-length="[10,10]" data-parsley-length-message="Mobile number should be 10 digit long." class="form-control" placeholder="Mobile" name="HeadMobile" required="" value="@_dr["HeadMobile"].ToString()" />
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Designation&nbsp;<span style="color: red">*</span></label>
                                                    <input type="text" id="txtHeadDesignation" class="form-control" placeholder="Designation" name="HeadDesignation" required="" value="@_dr["HeadDesignation"].ToString()" />
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Phone no&nbsp;<span style="color: red">*</span></label>
                                                    <input type="text" id="txtHeadPhone" class="form-control" placeholder="Phone no" name="HeadPhone" required="" data-parsley-pattern="^[^A-Z^a-z]+$" data-parsley-pattern-message="Invalid phone number entered." value="@_dr["HeadPhone"].ToString()" />
                                                </div>
                                            </div>
                                        </div>
                                        <h4 class="form-title-h4">Nodal officer details</h4>
                                        <div class="row">
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Prefix&nbsp; <span style="color: red">*</span></label>
                                                    <select class="form-control" name="NodalPrefix" required="">
                                                        <option value="">--Select Prefix--</option>
                                                        <option @(_dr["NodalPrefix"].ToString() == "Mr." ? "selected" : "")>Mr.</option>
                                                        <option @(_dr["NodalPrefix"].ToString() == "Mrs." ? "selected" : "")>Mrs.</option>
                                                        <option @(_dr["NodalPrefix"].ToString() == "Miss." ? "selected" : "")>Miss.</option>
                                                        <option @(_dr["NodalPrefix"].ToString() == "Dr." ? "selected" : "")>Dr.</option>
                                                        <option @(_dr["NodalPrefix"].ToString() == "Prof." ? "selected" : "")>Prof.</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>First Name&nbsp; <span style="color: red">*</span></label>
                                                    <input type="text" id="txtNodalFirstName" class="form-control" placeholder="First Name" name="NodalFirstName" required="" value="@_dr["NodalFirstName"].ToString()" />
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Last Name&nbsp; <span style="color: red">*</span></label>
                                                    <input type="text" id="txtNodalLastName" class="form-control" placeholder="Last Name" name="NodalLastName" required="" value="@_dr["NodalLastName"].ToString()" />
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Email&nbsp; <span style="color: red">*</span></label>
                                                    <input type="email" id="txtNodalEmail" class="form-control" placeholder="Email" name="NodalEmail" required="" value="@_dr["NodalEmail"].ToString()" />
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Mobile&nbsp; <span style="color: red">*</span></label>
                                                    <input type="text" id="txtNodalMobile" data-parsley-type="number" data-parsley-length="[10,10]" data-parsley-length-message="Mobile number should be 10 digit long." class="form-control" placeholder="Mobile" name="NodalMobile" required="" value="@_dr["NodalMobile"].ToString()" />
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Designation&nbsp;<span style="color: red">*</span></label>
                                                    <input type="text" id="txtNodalDesignation" class="form-control" placeholder="Designation" name="NodalDesignation" required="" value="@_dr["NodalDesignation"].ToString()" />
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <label>Phone no&nbsp;<span style="color: red">*</span></label>
                                                    <input type="text" id="txtNodalPhone" class="form-control" placeholder="Phone no" name="NodalPhone" required="" data-parsley-pattern="^[^A-Z^a-z]+$" data-parsley-pattern-message="Invalid phone number entered." value="@_dr["NodalPhone"].ToString()" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12">
                                                <button class="btn btn-info btn-lg" type="submit" id="btnSave">Submit</button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                            }
                                        }
                                    }
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section styles{
    <style>
        .table {
            color: #000;
        }

            .table .table {
                background-color: #fff;
            }

                .table .table th {
                    text-align: center;
                    font-weight: 800;
                    color: #000;
                }
    </style>
}
@section scripts{
    <link href="~/assets/lib/sweetalert2/sweetalert2.min.css" rel="stylesheet" />
    <script src="~/assets/lib/sweetalert2/sweetalert2.min.js"></script>
    <script src="~/assets/lib/parsley/parsley.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            ////initialize the javascript
            //App.init();
            ////Runs prettify
            //prettyPrint();
            $('#btnSave').on('click', function (e) {
                e.preventDefault();
                var frm = $('#frm');
                var frmParsley = frm.parsley();
                frmParsley.validate();
                if (!frm.parsley().isValid()) {
                    return false;
                }
                var btn = $(this);
                btn.addClass('disabled');
                btn.text('Processing...');

                $.ajax({
                    method: 'POST',
                    url: $('#hdfBaseUrl').val() + 'Admin/ChangeNodalHead/Save_Nodal_Head_Details',
                    data: frm.serialize(),
                    async: false
                }).done(function (data) {
                    if (data['flag'].toString().toLowerCase() == '-1') {
                        swal("Oops...!", "Head officer details already exists.");
                        btn.text('Save');
                        btn.removeClass('disabled');
                    } else if (data['flag'].toString().toLowerCase() == '-2') {
                        swal("Oops...!", "Nodal officer details already exists.");
                        btn.text('Save');
                        btn.removeClass('disabled');
                    } else {
                        swal({
                            title: "Success!",
                            text: "Data saved successfully",
                            type: "",
                            closeOnConfirm: true,
                            confirmButtonText: "OK",
                            confirmButtonClass: 'btn-primary',
                            showLoaderOnConfirm: true,
                        }).then(function () {
                            window.location.href = $('#hdfBaseUrl').val() + "Admin/ChangeNodalHead";
                        });
                    }
                    btn.removeClass('disabled');
                    btn.text('Save');
                }).error(function () {
                    swal("Oops...!", "Please try after some time");
                    btn.text('Save');
                    btn.removeClass('disabled');
                });
                btn.removeClass('disabled');
                btn.text('Save');
            });

        });
    </script>
}