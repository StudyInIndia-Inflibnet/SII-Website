function page_event() { "1" != $("#hdncheckvalidation").val() ? (page_click(), Bind_Grid(), Bind_StudentFieldList()) : swal({ title: "Warning", text: "Please provide complete student information before proceeding choice filling.", type: "warning", closeOnConfirm: !0, confirmButtonText: "OK", confirmButtonClass: "btn-primary", showLoaderOnConfirm: !0 }).then(function () { }) } function FillConditionalDropdown() { $(".CourseChange").on("change", function () { $("#drpBranch").html(""), $("#drpBranch").append('<option value="">-Select-</option>'), $("#drpNatureofcourse").html(""), $("#drpNatureofcourse").append('<option value="">-Select-</option>'), $.ajax({ method: "POST", url: "/admission/ChoiceFilling/SelectNatureofcourse", async: !1, data: { Discipline_ID: $("#drpDiscipline").val(), ProgramLevel_Id: $("#drpProgramLevel").val() } }).done(function (e) { $("#drpNatureofcourse").html(""), $("#drpNatureofcourse").prepend('<option value="">--Select--</option>'), $.each(e.List, function (e, t) { $("#drpNatureofcourse").append('<option value="' + t.Natureofcourse_Id + '">' + t.NatureOfCourse + "</option>") }) }).error(function () { $("#drpNatureofcourse").html(""), $("#drpNatureofcourse").append('<option value="">-Select-</option>') }), Bind_Grid() }), $("#drpNatureofcourse").on("change", function () { var e = $(this).val(); $.ajax({ method: "POST", url: "/admission/ChoiceFilling/SelectBranch", async: !1, data: { Natureofcourse_Id: e } }).done(function (e) { $("#drpBranch").html(""), $("#drpBranch").prepend('<option value="">--Select--</option>'), $.each(e.List, function (e, t) { $("#drpBranch").append('<option value="' + t.Branch_Id + '">' + t.Branchname + "</option>") }) }).error(function () { $("#drpBranch").html(""), $("#drpBranch").append('<option value="">-Select-</option>') }), Bind_Grid() }), $("#drpBranch").on("change", function () { Bind_Grid() }) } function page_click() { $("#btnsavechoicefilling").on("click", function (e) { e.preventDefault(); var t = ""; $(".loading").show(), $("#tbodyFill  > tr").each(function () { $this = $(this), t = "" == t ? $(this).attr("id") : t + "," + $(this).attr("id") }), $.ajax({ method: "POST", url: "/admission/ChoiceFilling/update_StudentChoiceFilling", data: { ID: t }, async: !1, success: function (e) { } }).done(function (e) { $(".loading").hide(), "true" == e.flag.toString().toLowerCase() && swal({ title: "Saved", text: "Your Choice Filling Saved Successfully..!!", type: "success", closeOnConfirm: !0, confirmButtonText: "OK", confirmButtonClass: "btn-primary", showLoaderOnConfirm: !0 }).then(function () { $(".swal2-overlay").hide(), Bind_StudentFieldList() }) }).error(function () { swal("Oops...!", "Something went wrong! Please try again."), btn.text("Save"), btn.removeClass("disabled") }) }), $("#btnsavechoice").on("click", function (e) { e.preventDefault(); var t = $("#frmStep2"); return t.parsley().validate(), !!t.parsley().isValid() && ($("#drpchangeseqfrom").val() == $("#drpchangeseqto").val() ? (swal({ title: "Can't Select Same Choice Number ", text: "Same Choice", type: "warning" }), void $(".swal2-overlay").hide()) : ("" != $("#drpchangeseqfrom").val() && "" != $("#drpchangeseqto").val() && $.ajax({ method: "POST", url: "/admission/ChoiceFilling/UpdateSequenceNumber_swap_move", data: t.serialize(), async: !1, success: function (e) { } }).done(function (e) { "true" == e.flag.toString().toLowerCase() && swal({ title: "Saved", text: "Your Choices have been swapped successfully..!!", type: "success", closeOnConfirm: !0, confirmButtonText: "OK", confirmButtonClass: "btn-primary", showLoaderOnConfirm: !0 }).then(function () { $(".swal2-overlay").hide(), Bind_StudentFieldList() }) }).error(function () { swal("Oops...!", "Something went wrong! Please try again."), btn.text("Save"), btn.removeClass("disabled") }), void $("#drptypechoicefilling").val(""))) }), $("#tbodyCourse").on("click", ".btnGridAdd", function (e) { e.preventDefault(); var t = $(this).attr("data-id"); $(".loading").show(); var a = $(this).attr("data-SeatWaiver"); $.ajax({ method: "POST", url: "/admission/ChoiceFilling/Insert_InstituteList", data: { InstituteCourse_ID: t, SeatWaivertype: a }, success: function (e) { } }).done(function (e) { "false" == e.flag.toString().toLowerCase() ? (swal({ title: "Some Institute Already Exist", text: "Some Institute Exist!", type: "warning" }), btn.text("Save"), btn.removeClass("disabled")) : "true" == e.flag.toString().toLowerCase() && (Clear(), Bind_Grid(), Bind_StudentFieldList()), $(".loading").hide() }).error(function () { swal("Oops...!", "Something went wrong! Please try again."), btn.text("Save"), btn.removeClass("disabled"), $(".loading").hide() }) }), $("#tbodyFill").on("click", ".btnGridDelete", function (e) { e.preventDefault(); var t = $(this).attr("data-id"); swal({ title: "Are you sure?", text: "You will not be able to recover this data!", type: "warning", closeOnConfirm: !0, showCancelButton: !0, confirmButtonText: "Yes, delete it!", confirmButtonClass: "btn-warning", showLoaderOnConfirm: !0 }).then(function () { $.ajax({ method: "POST", url: "/admission/ChoiceFilling/Delete_InstituteList", data: { ID: t }, success: function (e) { } }).done(function (e) { swal("Deleted!", "Your data has been deleted.", "success"), Clear(), Bind_Grid(), Bind_StudentFieldList() }).error(function () { swal("Oops...!", "Something went wrong from our side.", "error") }) }) }), $("#tbodyFill").on("click", ".btnupdown", function (e) { e.preventDefault(), Rearrange_Index() }), $("#tbodyCourse").on("click", ".btnGridopenmodel", function () { var e = $(this); $.ajax({ method: "get", async: !1, url: "/admission/ChoiceFilling/SelectCourseOffers", data: { ID: e.attr("data-id") }, success: function (e) { } }).done(function (e) { var t = e.List[0]; $("#lblDiscipline").text(t.Discipline), $("#lblProgramLevel").text(t.ProgramLevel), $("#lblNatureofcourse").text(t.Natureofcourse), $("#lblBranchName").text(t.BranchName), $("#lblEligibilityCriteria").text(t.EligibilityCriteria), $("#lblSeatForForeignStudent").text(t.SeatForForeignStudent), $("#lblAnnualTutionFees").text(t.AnnualTutionFees + " " + t.AnnualTutionFeesCurrency), $("#lblAnnualBoardingFees").text(t.AnnualBoardingFees + " " + t.AnnualBoardingFeesCurrency), $("#lblCourseDurations").text(t.CourseDurations), $("#txtClassrooms").text(t.ClassRoomHours), $("#lblCoursePatterns").text(t.CoursePatterns), $("#lblAdmissionReq").text(t.AdmissionReq) }).error(function () { swal("Oops...!", "Something went wrong! Please try again.") }) }) } function Clear() { } function Bind_Grid() { $(".loading").show(); $("#frmStep1"); $(".data-grid1").DataTable().clear().destroy(), $("#tbl").DataTable({ processing: !0, serverSide: !0, filter: !0, orderMulti: !1, pageLength: 25, ajax: { url: "/admission/ChoiceFilling/SelectInstitutePaging", data: { Discipline_ID: $("#drpDiscipline").val(), ProgramLevel_Id: $("#drpProgramLevel").val(), Natureofcourse_Id: $("#drpNatureofcourse").val(), Branch_Id: $("#drpBranch").val() }, type: "POST", datatype: "json" }, columns: [{ data: "tbl_InstituteCourse_ID", name: "tbl_InstituteCourse_ID", visible: !1, searchable: !0 }, { data: "InstituteID", name: "InstituteID", visible: !1, searchable: !0 }, { data: "InstituteName", name: "InstituteName", orderable: !1 }, { data: "Natureofcourse", render: function (e, t, a) { return "display" === t && (e = '<a class="btnGridopenmodel" data-toggle="modal" data-target="#form-bp1" data-id="' + a.tbl_InstituteCourse_ID + '">' + e + "</a>"), e } }, { data: "G1SeatWaiver", name: "G1SeatWaiver", orderable: !1, visible: !1, searchable: !0 }, { data: "G2SeatWaiver", name: "G2SeatWaiver", orderable: !1, visible: !1, searchable: !0 }, { data: "G3SeatWaiver", name: "G3SeatWaiver", orderable: !1, visible: !1, searchable: !0 }, { data: "G4SeatWaiver", name: "G4SeatWaiver", orderable: !1, visible: !1, searchable: !0 }, { mRender: function (e, t, a) { return ("1" == a.G1SeatWaiver ? '<a class="label label-danger not-active"  data-id="' + a.tbl_InstituteCourse_ID + '">G1</a> ' : "2" == a.G1SeatWaiver ? '<a class="label label-primary"  data-id="' + a.tbl_InstituteCourse_ID + '">G1</a> ' : '<a class="label label-success btnGridAdd" title="100% fee waiver on academic fees" data-toggle="tooltip" data-SeatWaiver="G1" data-id="' + a.tbl_InstituteCourse_ID + '" >G1</a> ') + " " + ("1" == a.G2SeatWaiver ? '<a class="label label-danger not-active"  data-id="' + a.tbl_InstituteCourse_ID + '" disabled >G2</a> ' : "2" == a.G2SeatWaiver ? '<a class="label label-primary" data-id="' + a.tbl_InstituteCourse_ID + '" disabled >G2</a> ' : '<a class="label label-success btnGridAdd" title="50% fee waiver on academic fees" data-toggle="tooltip" data-SeatWaiver="G2" data-id="' + a.tbl_InstituteCourse_ID + '" >G2</a> ') + " " + ("1" == a.G3SeatWaiver ? '<a class="label label-danger not-active " data-id="' + a.tbl_InstituteCourse_ID + '" disabled >G3</a> ' : "2" == a.G3SeatWaiver ? '<a class="label label-primary"   data-id="' + a.tbl_InstituteCourse_ID + '" disabled>G3</a> ' : '<a class="label label-success btnGridAdd" title="25% fee waiver on academic fees" data-toggle="tooltip" data-SeatWaiver="G3" data-id="' + a.tbl_InstituteCourse_ID + '" >G3</a> ') + ("1" == a.G4SeatWaiver ? '<a class="label label-danger not-active "  data-id="' + a.tbl_InstituteCourse_ID + '" disabled >G4</a> ' : "2" == a.G4SeatWaiver ? '<a class="label label-primary"   data-id="' + a.tbl_InstituteCourse_ID + '" disabled >G4</a> ' : '<a class="label label-success btnGridAdd" title=" 0% fee waiver on academic fees " data-toggle="tooltip" data-SeatWaiver="G4" data-id="' + a.tbl_InstituteCourse_ID + '" >G4</a> ') } }] }), $(".loading").hide() } function Bind_StudentFieldList() { $(".loading").show(); var e = $("#frmStep2"); $(".ChoiceNumberChange").html(""), $(".ChoiceNumberChange").prepend('<option value="">--Select--</option>'), $("#tbodyFill").html(""), $.ajax({ method: "GET", async: !1, url: "/admission/ChoiceFilling/Select_Filled_Institute", data: e.serialize(), success: function (e) { } }).done(function (e) { var t = 1, a = "'tr:first'"; $(".data-grid2").DataTable().clear().destroy(), $.each(e.List, function (e, n) { var i = $("<tr id=" + n.ID + " data-moduleid=" + n.InstituteID + "></tr>"); i.append("<td><strong>" + t++ + "</strong></td>"), i.append("<td>" + n.InstituteName + "</td>"), i.append("<td>" + n.Natureofcourse + "</td>"), i.append("<td>" + n.SeatWaivertype + "</td>"), UPbtn = '<a class="label label-success btnGridUp btnupdown" onclick="$(this).parents(' + a + ").insertBefore($(this).parents(" + a + ').prev())"; title="To Move Up" data-toggle="tooltip" type="button" data-id="' + n.ID + '" ><i class="glyphicon glyphicon-arrow-up"></i></a>', Downbtn = '<a class="label label-warning btnGridDown btnupdown" onclick="$(this).parents(' + a + ").insertAfter($(this).parents(" + a + ').next())"; title="To Move Down" data-toggle="tooltip" type="button" data-id="' + n.ID + '" ><i class="glyphicon glyphicon-arrow-down"></i></a>', dtlbtn = '<a class="label label-danger btnGridDelete" title="To delete your choice" data-toggle="tooltip" type="button" data-id="' + n.ID + '" ><i class="glyphicon glyphicon-remove"></i></a>', i.append("<td>" + UPbtn + "&nbsp;&nbsp;" + Downbtn + "&nbsp;&nbsp;" + dtlbtn + "</td>"), $("#tbodyFill").append(i), $(".ChoiceNumberChange").append('<option value="' + n.ID + '">' + n.SequenceNumber + "</option>") }), InitDatatablestbl2(), $(".loading").hide() }).error(function () { $(".loading").hide(), swal("Oops...!", "Something went wrong! Please try again.") }) } function GetInstituteCheckedList() { var e = [], t = 1; return $("#tbodyCourse").each(function (a, n) { $(this).find("tr").each(function (a, n) { var i = $(this).find(".ChkAdd"), o = $(this).attr("data-moduleid"), r = $(this).attr("id"), l = !1; i.is(":checked") && (l = !0), 1 == l && (e.push({ Institute_Id: o, InstituteCourse_ID: r, SequenceNumber: t, Student_ID: $("#hdfstudentid").val() }), t += 1) }) }), JSON.stringify(e) } function Rearrange_Index() { var e = 1; $("#tbodyFill > tr > td > strong").each(function () { $(this).text(e), e++ }) } function MoveUp(e) { $(e).parents("tr:first").insertBefore($(this).parents("tr:first").prev()) } function MoveDown(e) { $(this).parents("tr:first").insertAfter($(this).parents("tr:first").next()) } function InitDatatablestbl() { $("#tbl").DataTable({ processing: !0, serverSide: !0, filter: !1, orderMulti: !1, ajax: { url: "/admission/ChoiceFilling/SelectInstitutePaging", type: "POST", datatype: "json" }, columns: [{ data: "tbl_InstituteCourse_ID", name: "tbl_InstituteCourse_ID", autoWidth: !0 }, { data: "InstituteID", name: "InstituteID", autoWidth: !0 }, { data: "InstituteName", name: "InstituteName", autoWidth: !0 }, { data: "Natureofcourse", name: "Natureofcourse", autoWidth: !0 }] }) } function InitDatatablestbl2() { $("#tbl2").DataTable({ ordering: !1, bDestroy: !0, scrollY: "350px", scrollCollapse: !0, paging: !1 }) } $(document).ready(function () { page_event(), FillConditionalDropdown() });