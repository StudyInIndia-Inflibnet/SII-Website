function page_events() { page_click_events() } function page_click_events() { $("#btnChangePassword").on("click", function (a) { a.preventDefault(); var e = $("#frm"); if (e.parsley().validate(), !e.parsley().isValid()) return !1; if ($("#txtOldPassword").val() == $("#txtNewPassword").val()) return ErrorMessageCallBack("New password cannot be same as previous.", function () { $("#btnRefreshCaptcha").trigger("click"), $("#txtCaptcha").val(""), $("#txtNewPassword").val(""), $("#txtRetypePassword").val(""), $("#txtNewPassword").focus() }), !1; var t = $(this); t.text("Processing..."), t.addClass("disabled"), $.ajax({ method: "POST", url: "/admission/changepassword/Check_And_ChangePassword", data: e.serialize() + "&CaptchaStr=" + $("#txtCaptcha").val() }).done(function (a) { "true" == a.flagCaptcha.toString().toLowerCase() ? "true" == a.flagPwdChanged.toString().toLowerCase() ? (t.text("Redirecting..."), SuccessMessageCallBack("Your password has been changed successfully. You are being redirected to login page...", function () { window.location.href = "/admission/Login" })) : (t.text("Change Password"), t.removeClass("disabled"), ErrorMessageCallBack("Invalid old password.", function () { window.location.href = window.location.href }), $("#btnRefreshCaptcha").trigger("click"), $("#txtCaptcha").val("")) : (t.text("Change Password"), t.removeClass("disabled"), ErrorMessageCallBack("Invalid captcha entered.", function () { window.location.href = window.location.href }), $("#btnRefreshCaptcha").trigger("click"), $("#txtCaptcha").val("")) }).error(function () { t.text("Change Password"), t.removeClass("disabled"), ErrorMessageCallBack("Somthing went wrong. Please try again.", function () { window.location.href = window.location.href }), $("#btnRefreshCaptcha").trigger("click"), $("#txtCaptcha").val("") }) }) } $(document).ready(function () { $("#btnChangePassword").show(), $("#btnRefreshCaptcha").show(), page_events() });